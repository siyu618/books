### 1. 初识推荐系统

1. 推荐系统的定义：推荐系统是一种信息过滤系统，用于预测用户对物品的打分和偏好。
2. 推荐系统的本质：是一种信息匹配系统， 主要作用是在信息过载场景下提升匹配效率，即用户和目标信息之间的触达效率。 
3. 信息系统的参与者：信息生产者，信息消费者和互联网信息平台。
4. 推荐系统的核心模块
	1. 内容理解：理解和刻画推荐内容
	2. 用户啊画像：理解和刻画用户
	3. 召回：为用户筛选内容
	4. 排序：为用户精选内容
	5. 重排：从业务角度进行内容调整
		1. 建模角度一般是从中选出最优的序列组合。 list wise。
	6. 推荐系统质量评估体系
		1. 用户消费满意度：用户留存、停留时长、多样性、准确性、新颖性
		2. 场景转化指标：点击率、转化率
		3. 内容生态指标：覆盖率、时效性、挖掘常委能力、内容攻击能力。 
		4. 系统服务指标：服务耗时 p99, p999,; 错误率；并发度 qps。

### 2. 多模态时代的内容理解
1. 内容标签体系建设
	1. 标签体系作用：可以完成内容可理解、用户可识别、算法可解释、运营可以干预
	2. 标签体系的设计和建设
		1. 标签分为：内容标签和类型标签。
			1. 内容标签：是根据推荐内容生成的标签。 
			2. 类型标签：是一个预先定义好的分类体系，是结构化的标签体系。 
2. 知识图谱
	1. 知识图谱提供了内容之间的复杂的语义关联。 
3. 内容李俊杰的产出可以作用于推荐系统的各个环节。 
	1. 全链路特征： 用户画像；试探召回，属性找回，向量召回； 粗排；精排；重排
	2. 内容试探
	3. 优质内容库：优质冷启动内容库；年龄层内容库。

### 3. 用户画像
1. 用户画像：就是为用户画像一边更好地理解用户。
2. 用户画像的作用：个性化推荐、精准营销、经营分析、广告投放、数据统计和挖掘等。 
3. 用户画像构建系统：
	1. 数据层：业务数据、日志数据、行为上报数据、第三方数据。
	2. 计算与存储层：
		1. 计算：流式计算 + 批处理
		2. 存储：Mysql，Hbase，Redis，Hive，HDFS
	3. 画像标签建模层
		1. 人口属性标签
		2. 行为属性标签
		3. 消费属性标签
		4. 偏好属性标签
		5. 用户分层属性标签
	4.  应用层：推荐系统、广告投放系统；营销决策系统；运行分析系统。
4. 用户标签体系
	1. 用户基础属性标签
		1. 人口属性
		2. 社会属性
		3. 地理属性
		4. 设备属性
	2. 用户社交属性标签
		1. 家庭关系
		2. 社交关系
		3. 社交偏好
		4. 社交活跃度
	3. 用户行为属性标签
		1. 行为主体：用户
		2. 行为对象：内容/物品
		3. 行为时间：发生事件/持续时间
		4. 行为类型：浏览、互动、搜索、付费。
		5. 行为上下文：网络环境、天气、行为路径。
	4. 用户兴趣标签
		1. 标签权重 = 行为权重 * 行为次数 * 时间衰减因子
	5. 用户分层标签
		1. RFM 模型：Recency、Fequency、Monetary
		2. 生命周期：引导期、成长期、成熟期、流失期。
		3. 活跃度分层：高、中、低、新
		4. 消费水平分层：高付费、中付费、低付费、无付费

### 4. 包罗万象的召回
1. 推荐系统的本质是信息过滤，召回阶段作为首个信息楼都，从多个维度将海量信息中用户最有可能感兴趣的内容过滤出，交割后续的排序技术处理，它决定着推荐系统的效果上限。 
2. 召回的基本逻辑和方法论
	1. 重要性：排序技术需要多个召回源作为待排序的内容。 
	2. 召回与排序的区别：

| |召回|排序|
|---|---|---|
|过滤结果|多|少|
|过滤粒度|粗|细|
|流程特点|横向广度|纵向深度|
|扩展性|高|低|
|性能与存储要求|低|高|
|模型特征|少|多|

 3. 主要的召回策略与算法
		1. 传统召回算分策略： 协同过滤
		2. 向量化模型召回：Embedding
		3. 基于用户行为序列的召回
		4. 图模型相关召回
3. 传统召回策略
	1. 基于内容的召回：Content based recall， CB
		1. 标签召回
		2. 优点：不需要依赖其他用户的数据，只需要有单个用户的数据即可。
		3. 缺点：物品的特征表示依赖于人工设计，需要大量领域的知识， 其召回效果依赖于手工设计特征的好坏。 
	2. 经典协同过滤召回：Collaborative Filtering
		1. 基于用户的协同过滤
			1. 考虑用户之间的相似性
		2. 基于内容的协同过滤
			1. 找物品之间的相似性
		3. 基于模型的协同过滤
			1. 方法：关联算法、聚类算法、分类算法、回归算法、矩阵分解、神经网络、图模型以及隐语义模型。
		4. 优缺点
			1. 优点：不需要相关的领域知识
			2. 缺点：对新用户或新物品不太友好，模型预测需要由用户或物品的关联行为。 
	3. 探索类召回: E&E
4. 向量化模型召回
	1. 万物皆可向量化
	2. 向量化模型召回的原理
		1. 将物品与内容通过模型转换为低维空间中的 Embedding，向量间的距离可以衡量物品或内容之间的相似性。 
	3. 从 KNN 到 ANN
		1. KNN K-Nearest Neighbor
		2. ANN Approximate Nearest Neighbor： 搜索可能是近邻的数据项，而不再局限于返回最优的数据项，在可接受范围内牺牲精度来提高检索效率。 
			1. 引入了 KD-Tree 算法。
			2. 常见编码方法：局部敏感散列（LSH），矢量化方法
	4. 经典向量化召回模型
		1. Word2Vec：利用词序列生成Embedding
		2. Item2Vec：利用物品序列构造物品Embedding
			1. 最终目标是得到物品 Embedding 和用户 Embedding
			2. 没有使用时间窗口概念。
5. 基于用户行为序列的召回
	1. 前提假设：用的行为前后都存在极强的关联性甚至是因果关系。
	2. 召回模型
		1. SASRec： 经典行为序列召回模型
		2. BERT4Rec 与 BST - NLP 技术与用行为序列结合
		3. MIND 及其衍生 - 多兴趣模型召回
		4. 超长序列召回 - 建模用户全期兴趣
6. 图 Embedding 召回
	1. 图 Embedding 技术： 图表示是或图 Embedding 学习，将图中心丰富的结构和语义信息转化为低纬度稠密的节点表示向量。
	2. DeepWalk 经典图 Embedding 方法
	3. Node2Vec - DeepWalk 更进一步 
	4. PinSAGE - GCN 在推荐系统领域的工业化应用
	5. MetaPathVec - 异构图 Embedding 方法
7. 前瞻性召回策略与模型
	1. TDM： 模型与索引结合的艺术
	2. 对比学习法：样本的魔法
8. 召回质量评估方法
	1. 召回评估方法
		1. 发奋评估指标
		2. 集合评估指标
		3. 排名评估指标
	2. 召回率、精确率、F1 值
	3. HR (hit rate)\ARHR - Top N 推荐评价指标
	4. CG DCG NDCG 信息增益维度的评估指标
	5. 长尾覆盖评估

### 5. 投你所好的排序环节
1. 排序环节的意义和优化方向
	1. 意义：相比于召回阶段，排序接管要求高效且准确反馈结果。 
	2. 优化方向
		1. 业界的模型通常采用的是点击率预估的方案。 
		2. 目前主要优化的方向：
			1. 模型对 Embedding 的高效学习和利用
			2. 粗排环节的优化
				1. 减少粗排与精排预估能力差距
				2. 增强链路目标一致性
			3. 多目标建模和融合问题
				1. 通过知识的迁移学习，同时优化多个目标的学习。
2. 从 Embedding 看模型排序的演进
	1. 什么是 Embedding：是一种将类别型特征因设为包含连续值向量的技术。
		1. 相比于 One-hot编码，有效的减少了内存的使用。
	2. Embedding 产生的过程
		1. FM
		2. FFM
		3. 矩阵分解到神经网络
	3. 特征组合在深度排序模型中的应用
	4. 用户历史行为建模在深度排序模型中的应用
	5. 超大规模 Embedding 在实际中的应用
3. 推荐系统粗排阶段及其发展历程
	1. 为了平和算力和收益，将排序拆分为粗排和精排两个阶段。
		1. 粗排作为召回和精排中间的环节，起到承上启下的作用。
		2. 粗排的目标是减轻精排的眼里， 在满足 RT、算力约束和保证筛选效果的情况下，将召回得到的万量级别物品进一步筛选到千量级，然后送入精排。
	2. 粗排定位和技术路线选择
		1. 粗排需要与精排目标上保持一定的一致性。 
		2. 粗排更重于性能。 
		3. 粗排模型的烟花基本是按照“减少与精排预估能力差距” 和 “增强链路目标一致性”的方向优化。 
		4. 模型优化的方法主要有三个
			1. 提升模型精度：对其竞拍模型复杂的特征和交互组件，蒸馏技术进行知识迁移。 
			2. 优化模型性能：利用蒸馏、量化特征筛选、网络兼职、深度结构搜索等技术简化模型结构、、减少特征传输、并结合底层优化计算效率。
			3. 缓解空间分布差异和样本选择偏差问题（SSB）。
	3. 粗排模型架构的演变
	4. 使用知识蒸馏增强粗排与精排的一致性。
		1. Teacher-Student 模式
	5. 缓解样本选择偏差
		1. 精排模型通常是用展点数据进行训练，其样本空间是基于展示物品的。 
		2. 粗排的样本空间是找回出的所有物，粗排的样本空间是召回的自己，是精排的超集。
	6. 粗排效果的评价
		1. 粗排是精排预估的能力迁移，因此除了常用的 AUC、GAUC 还需要考虑粗排与精排的对其程度。 
		2. 对线上性能要求较高，评价排序模型包括 qps 和 RT。
4. 多目标排序建模
	1. 多目标排序建模的意义和挑战
		1. 传统的排序模型采用点击率预估的思路进行建模，但是点击率预估模型不关心用户点击后的消费情况。
		2. 在推荐系统中，除了将用户和推荐系统作为参与者，还需要考虑供给方的需求。 
		3. 建立和优化多目标模型，对于提升用户体验、改进推荐系统分发效率、增强参与者的积极性和改善生态具有重要的意义。 
		4. 多目标排序建模方法概览
			1. 样本权重融合，该方法一般哟一著目标，然后通过调节其他目标对样本权重的影响，达到同时优化多个目标的效果。 
				1. Weighted 
			2. 多模型分数融合，该方法为每一个目标都单独训练一个模型，然后融合多个模型的预估值并排序。
				1. Point wise
			3. 排序学习，该方法通过将不同目标（用户行为）转化为推荐候选集间的相对顺序来解决多目标学习问题。
				1. Pair wise
				2. List wise
			4. 多任务学习，在多个任务间共享部分底层网络结构，其本质是通过部分参数的共享和个任务私有参数的独立，来学习多个任务间的共性和差异。
				1. 共享参数的多塔 DNN
				2. MMoE/PLE
				3. ESMM/ESCM2
5. 推荐系统排序阶段的评估
	1. 离线评估
		1. 基于训练样本进行训练后，利用得到的模型在测试样本上进行测试，得到指定的评估指标。
	2. 线上评估
		1. 在实际业务中应用模型，利用真是的用户数据进行评估，得到人均时长、点击率、收入等指标 。
	3. 系统评估指标
	4. 离线和线上效果一致性问题
		1. 特征不一致
		2. 样本穿越问题
		3. 评估指标问题

### 6. 权衡再三重排序
1. 重排序的必要性和作用
	1. 用户体验：兼顾用户视觉体验，优化推荐展示效率。
		1. 推荐结果打散
		2. 推荐结果去重
		3. 多样性保障
	2. 业务规则： 平衡和兼顾产品、运营、商业化等业务规则。
		1. 混排策略
		2. 产品策略
		3. 运营策略
		4. 流量调控
	3. 模型策略：重排序阶段建模，在序列的尺度上进行效率最优化
		1. List Wise 冲排序模型
		2. 端上重排序
2. 重拍模型
	1. 出发点：精排通常没有考虑信息上下文的影响。
		1. 如何最大化整个序列推荐的价值，是重拍模型建模的一个重要出发点。 
	2. 序列重排序模型
	3. 基于强化学习的重排模型。 
3. 重排多样性策略
	1. 多样性的出发点：多样性会对产品短期的用户体验几长期的用户留存等目标有比较到的影响。 
		1. 方法：基于规则约束；启发式算法；深度模型。
	2. 多样性评估指标：覆盖率、K次重复、SSD、海宁格距离、人工评估。 
	3. 规则多样性打散：分桶打散法、权重分配法、滑动窗口
	4. 多样性模型策略：MMR、行列式过程 DPP、基于深度学习的 DPP
4. 重排中的业务规则
	1. 重排阶段还承担了很多产品运营策略相关的工作。

### 7. 如若初见冷启动
1. 好多而冷启动推荐体验牵涉到差您、运营、数据、算法、工程等多方面的工作。 
2. 定义和挑战
	1. 定义：如何为新用户推荐合适的内容，以及如何将创作者生产的新内容分发出去。
	2. 分类：新用户冷启动、新物料冷启动、平台冷启动。
		1. 新用户：难点在于对于新用户知之甚少，无法确定用户的真实兴趣
		2. 新内容：缺少用户行为的真实反馈。 
3. 冷启动的一般解决思路
	1. 设计有效的产品功能，手机用户的属性信息、社交信息、兴趣偏好等。 
	2. 做好用户画像标签体系和平台内容标签体系的建设，并做好内容标注和审核相关工作。 
	3. 完善内容制作模板，引导创作者晚上内容标题、摘要、标签等信息。 
	4. 与技术人员功能完善平台热门内容或者优质内容的筛选计算规则。 
	5. 冷启动推荐的出发点是提升推荐的返回性和实时性，或者利用迁移学习和少样本学习技术环节冷启动场景数据稀疏问题。 
		1. 泛化的本质：在获不到用户者内容个体维度的行为反馈数据时，可以泛化到或者内容更粗粒度的特征。 
			1. 内容推荐
			2. 人群热门
			3. 泛化表征向量
		2. 实时性的本质：高效地利用用户教书数据，不论是隐式还是显示、正向的还是负向的，推荐系统都要及时地不住这些交互反馈数据，及时调整分发策略。 
			1. 在线学习额
			2. 强化学习
			3. UCB试探
		3. 迁移学习：要决绝的问题本身就是在某领域知识不足的情况下，迁移其他领域的数据或知识，用于本领域的学习。 
			1. PeterRec
			2. 领域自适应
		4. 少样本学习旨在解决数据极少的情况下哦模型的训练和学习问题，以及数据稀缺的推荐冷启动问题。 
			1. 元学习
4. 新用户冷启动
	1. 新用户召回策略
		1. 热门召回 ： 通常表现不错
		2. 人口属性召回
		3. 来源素材召回
		4. 精品池召回
		5. Embedding 个性化向量召回
	2. 新用户排序模型
		1. 排序模型的训练样本依赖于用户行为日志，而这也是新用户所欠缺的。 
		2. 可采取的措施
			1. 新老用户模型分家，单独拆分新用户模型
				1. 避免新用户模型被高频活跃用户主导带偏。
			2. 引入先验知识，挖掘信息用户强相关特征
			3. 调整排序模型结构，使其对新老用户具备差异化学习能力
	3. 新用户重排策略
		1. 策略
			1. 新用户独立的多样性打散配置
			2. 新用户独立的商业化策略
			3. 针对新用户的产品或运营策略
5. 新物品分发冷启动
	1. 新物品分发冷启动的出发点是将创作者产生的最新内容及时有效地分发出去。 
	2. 新物品冷启动召回策略：
		1. 基于物品属性的召回
		2. 从用户角出发去匹配最感兴趣的新物品。 
	3. 新物品冷启动排序策略
		1. 独立的融合公式和参数进行融合打分才会更加合理。 
	4. 新物品冷启动流量分配机制
		1. 差异化保量
			1. 对作者侧指标友好。 
			2. 多轮保量机制
			3. 优化冷启动流量的杠杆效率
		2. 保量展现控速
			1. 提高冷启动样本的利用率，保障作者侧的发布反馈体验，避免几种曝光导致的动作率差损失消费指标。 
### 8. 推荐系统中的魔术手
1. 特征工程
	1. 有效的特征是模型发挥作用的前提。
	2. 特征的分类
		1. 用户特征
		2. 物品特征
		3. 上下文特征
		4. 交叉特征
	3. 特征挖掘维度
		1. 用户侧
			1. 用户属性：用户ID、人口学特征、群体
			2. 物品属性：用户对于物品ID、标签、作者的偏好统计
			3. 时间范围：过去N分钟/小时/天/月/年的范围统计
			4. 行为类型：点击、观看、互动、下单、购买、标记为不喜欢
			5. 统计目标：个数、时长、金额
			6. 统计方法：次数、时长、占比、时间排序/权重排序的Top K序列
		2. 物品侧
			1. 物品属性：ID、标签、作者、发布时间、时长、价格、产地
			2. 。。。。
		3. 交叉
			1. 手动交叉：二元组、三元组等贡献元组统计值；向量距离
			2. 模型自动交叉
		4. 上下文
			1. 天气
			2. 地点
			3. 时间
			4. 位置
	4. 工程视角下的特征工程开发
		1. 工程性问题
			1. 模型适配和一致性
			2. 置信度
			3. 模型学习难度 - 是否使用领域经验
			4. 计算复杂度：离线、在线、模型推理的复杂度
			5. 线上存储：存储系统选择
			6. 实时性
			7. 穿越问题：用未来预测过去
			8. 是否端到端：简化建模步骤
	5. 特征工程的流程和方法
		1. 特征提取
		2. 特征处理和清洗
		3. 降维
2. 样本加工艺术
	1. 如何提取有效样本
	2. 负样本优化
	3. 样本迁移
		1. 调整源场景的样本权重分布，使其匹配目标场景的样本分布。
3. 推荐系统实效性
	1. 推荐数据实效性
	2. 推荐模型实效性
	3. 在线学习整体机制
4. 推荐系统中的偏差与消偏策略
	1. 推荐偏差的缘由
		1. 数据收集引入的偏差
		2. 推荐策略带来的偏差
		3. 上述偏差会在 用户 - 数据 - 推荐系统 - 用户 的反馈环中不断地被放大。
	2. 消偏技术和策略
		1. 重调权
		2. 重标注
		3. 生成模型


### 9. 系统进化的利器 - AB 实验平台
1. AB 实验往往具有以下三种特性
	1. 先验性
	2. 并行性
	3. 科学性
2. AB 实验平台框架
	1. 实验场景
		1. 算法类
		2. 产品功能类
		3. 运营类
	2. 整体架构
		1. Web层：提供平台 UI，负责应用参数配置，实验配置，实验效果查看等功能 
		2. 服务层：提供权限控制、实验管理、拉取实验效果等功能
		3. 存储层：提供数据存储功能
		4. 业务层：业务层结合 SDK 完成获取实验参数和获取应用参数的功能。
3. AB 实验分流机制 & 实验类型
	1. 分流方案尽量满足三个核心目标
		1. 高度并行可扩展，能支持更多的实验，同时保证实验的灵活性
		2. 确保实验结果的准确性和合理性
		3. 能迅速创建实验以及快速获取实验分析结果
	2. 分流规划规则
		1. 随机分流
		2. 按照用户分流
4. AB 实验效果评估
	1. 推荐系统常见的 AB 指标
		1. 点击率
		2. 用户点击率
		3. 覆盖率
		4. 人均时长
	2. AB 实验的假设检验
		1. 中心极限定理和正态分布，z 检验
5. AB 实验不是万能的
	1. 证实偏差
	2. 幸存偏差
	3. 统计功效不足
	4. 辛普森悖论
	5. 均值回归
	6. 基于会话指标的谬误
### 10. 推荐系统中的前沿技术
1. 强化学习
2. 因果学习
3. 端上智能
4. 动态算力分配
5. 增益模型
6. ChatGPT
	1. 文本生成
	2. 自动摘要
	3. 问答任务
