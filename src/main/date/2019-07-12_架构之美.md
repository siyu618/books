# 架构之美

## Part 1. 论架构
### Chapter 1. 架构概述
* 架构的层次结构
* [采用视点和视角与利益相关者合作](https://book.douban.com/subject/24530471/)
   * 关注点分离
   * 视点（视图）：场景、功能、信息、并发、开发、部署、运维
   * 视角（质量属性）：安全、国际化、性能可扩展性、可用性
   * 一致性。
* 典型的利益相关者
   * 投资人：想知道醒目是否能够在给定的资源进度约束下完成
   * 架构师、开发人员和测试人员：首先要考虑的是最初的构建后后期的维护
   * 项目经理：需要组织团队，制定迭代计划
   * 市场人员：他们想通过品质特点实现与竞争者的差异化
   * 用户：包括最终用户、系统管理员，以及安装、部署、准备、配置人员
   * 技术支持人员：关注帮助平台电话呼入数目和复杂性。
* 品质：  
   * 性能、安全、可伸缩性
   * 可变性、可维护性、可用性
* 折中：各方面利益的均衡。
* 概念的完整性
   * 最好是让系统反映一组设计思想，而不是让让系统包含许多好的设计思想，而这些思想却彼此独立而不协调。
   * 处理问题的一致性：分解的判据、设计模式的应用和数据模式
* 关注点清单
   * 1. 功能性（functionality）：产品想他的用户提供哪些功能
   * 2. 可变性（changeability）：软件将来可能需要哪些改变？哪些改变不太可能发生，不需要特别容易进行这些改变？
   * 3. 性能（performance）：产品将达到怎样的性能。
   * 4. 容量（capacity）：多少用户将并发使用该系统？该系统将为用户存多少数据？
   * 5. 生态系统（ecosystem）：在部署的生态环境中，该系统将于其他系统进行哪些交互？
   * 6. 模块化（modularity）：如何将编写关键的任务分解为工作指派（模块），特别是这些模块可以独立开发，并能够准确而容易地满足彼此的需求？
   * 7. 可构建性（buildablity）：如何将软件构建为一组组件，并能够独立实现和验证这些组件？哪些组件应该服用其他的产品，哪些应该从外部供应商处获得？ 
   * 8. 产品化（producibility）：如果产品将以集中变体的形式存在，如何开发一个产品线，并利用这些的共性？产品险种的产品以怎样的步骤开发？在创造一条产品线时，要进行那些投资？开发产品线中不同的变体的选择，将会得到怎样的回报？ 特别是是否可能先开发最小有用的产品（MVP，Minum Variable Product），然后在添加（扩展）组件在不改变以前编写的编码的情况下，开发产品线的其他成员？
   * 9. 安全性（security）：产品是否需要用户认证，或者必须先知对数据的访问？数据的安全性如何得到保证？如何抵挡“拒绝服务”攻击或其他攻击？
* 架构结构
|结构|组件|关系|关注点|
|---|---|---|---|
|信息隐藏|信息隐藏模块|整体-部分；包含|可变性；模块化；可构建性|
|使用|程序|使用|产品化；生态系统|
|进程|进程（任务，线程）|提供工作；获取资源；共享资源；包含在模块中；etc|性能；可变性；容量|
|数据访问|程序和数据段|有权访问|安全性；生态系统|
* 评价体系
   * 确定架构属性，通过建模或模拟系统的一个或多个方面
   * 通过对架构师提出质询来评估架构

### Chapter 2. 两个系统故事：现代软件神话
* 混乱大都市（混乱带来的问题）
   * 不好的公司结构和不健康的开发过程将在糟糕的软件架构中得到反映
   * 不可理解：重要的是保持软件设计的品质。坏的架构设计会招致更坏的架构设计。
   * 缺乏内聚：开发团队中健康的工作关系将直接有益于软件设计。不健康的关系和个性膨胀导致不健康的软件。
   * 不必要的耦合：好的设计考虑到内部组件连接机制和连接数（以及连接性质）。系统的单个部分应该能够独立存在。紧耦合的系统将导致不可测试的代码。
   * 代码问题：松弛而模糊的架构将导致每个代码组件编写的不好，并且相互之间配合的不好。它也会导致重复的代码和工作。
   * 代码以外的问题：不良架构的影响不仅限于代码，它会进一步影响到人、团队、过程和时间表。
      * 开发团队、缓慢的开发周期、支持工程师、第三方支持、公司内政治。
   * 清晰的需求：中啊哟的是在开始设计系统之前知道你打算设计什么，如果你不知道它是什么，也不知道它将做什么，暂时不要开始设计它。只设计你知道需要的东西。
* 内聚和耦合：软件设计的关键品质。
   * 高内聚（strong cohesion）
      * 内聚是一个测量指标，说明相关的功能如何聚集在一起，模块作为整体工作得如何。
      * 弱内聚的模块是不良分解的信号。
      * 每个模块都必须有清晰定义的角色，而不只是一堆不相关的功能。
   * 低耦合（low coupling）
      * 耦合是模块之间独立性的测量指标——它们之间进出“电线”的数量。
      * 在最简单的设计中，模块几乎没有什么耦合，所以彼此之间依赖关系比较少。
      * 好的软件设计会先知通信的线路，只提供哪些绝对必要的。这种通信线路是确定架构的一部分因素。
* 设计之城
   * 决策细节
      * 顶层文件结构
      * 事物如何命名
      * “内部”展示的风格
      * 共用的编码惯例
      * 选择单元测试框架
      * 支持基础设施（例如版本控制，CI、CD）      
   * 设计
      * 定位动能：
         * 架构有助于定位功能：添加功能、修改功能或修复缺陷。它为你提供了一个模板，将工作拿到到系统导航图中。
         * 一致性
            * 清晰的架构设计将导致一致的系统。所有决定都应该在架构设计的背景下做出。
            * 清晰的架构有助于减少功能重复。
         * 架构的增长
            * 软件架构不是一成不变的。需要的时候就修改它。要想做到可以修改，架构就必须保持简单。牺牲简单性的修改要抵制。
         * 延迟的设计决定
            * 延迟设计决定，知道你必须做出这些决定为止。不要在你还不知道需求的时候就做出架构决定。不要猜测。
         * 保持品质
            * 必须保持架构品质。只有当开发者么相信他并对它负责时，才能做到这一点。
         * 管理技术债务
         * 单元测试打造了设计
            * 你的系统应该有一组不错的自动化测试，它们让你在进行根本的架构变更时风险最低。这为你提供了工作空间。
         * 设计时间
            * 好的项目计划带来优质的设计。分配足够的时间来创建架构杰作，它们不会立刻出现。
         * 与设计同行
            * 团队的组织方式必然对它产生的代码有影响。随着时间的推移，架构也会影响团队写的做的好坏。当团队瓦解时，代码的交互就很糟糕。当团队协作时，架构就集成的很好。
## Part 2. 企业应用级架构
### Chapter 3. 伸缩性架构

### Chapter 4. 记忆留存

### Chapter 5. 面向资源的架构：在 Web 中

### Chapter 6. 数据增长：Facebook 平台的架构

## Part 3. 系统架构
### Chapter 7. Xen 和虚拟化之美
* [虚拟化产品 - Xen、OpenVZ、KVM、Hyper-V、VMWare虚拟化技术介绍](https://www.cnblogs.com/sammyliu/articles/4389832.html)

### Chapter 8. Guardian：一个容错操作系统

### Chapter 9. JPC：一个纯 Java 的 x86 PC 模拟程序
* 达到“美丽架构”的途径是一个分为 4 个步骤的计划：
   * 1. 全面接受一个大而复杂的问题，找到一组比较简单、能够使构建完善的端到端的原型系统成为可能的阶段。每个阶段代表一个比最终目标简单和具有较少功能的系统，但是，每个阶段都可以在他的设计限制内作为完整系统原型的一部分进行测试，而不是作为最终设计的小部分单独原型（例如，比较传统的单元测试）。
   * 2. 在构建每个阶段的每一部分之前，清楚地知道正在开发哪个方面和为什么。理论上，每个阶段的瓶颈都可以容易地识别，对这些瓶颈的改进将是下面一些阶段的主要目标。原则上，在着手大块的工作之前，要努力找到办法证明这个方法是否可行——及时对于每个阶段的每一部分。
   * 3. 完成每个阶段的编码并对整个原型进行系统测试，抵制在阶段设计限制参数上快速推进的诱惑。一定要做到对每个阶段进行完整的系统测试才通知下一个阶段的测试。 
   * 4. 对设计进行迭代并返回第二步，无论在什么情况下，你都不应该担心重写全部的组件。
### Chapter 10. 元循环虚拟机的力量：Jikes RVM

## Part 4. 最终用户应用架构
### Chapter 11. GUN Emacs：滋长的特性是其优势
### Chapter 12：当集市开始构建教堂

## Part 5. 语言与架构
### Chapter 13. 软件架构：面向对象
### Chapter 14. 重读经典
* 现代建筑师 Louis Sullivan 著名的话语：
   * 不论是翱翔的雄鹰，或盛开的苹果花、辛苦工作的马匹、无忧无虑的天鹅、枝叶繁茂的橡树、晚宴的溪流、漂浮的云朵、飞奔的太阳，形式总是服从于功能，这就是自然的法则。功能不变，形式就不变。花岗岩、永恒乘机的山峦，常年不变；一闪而过的生命，生长成形，转瞬即逝。
   * * 这是所有事物的法则，无论有机还是无机、实体还是形而上的、关于人的还是关于超人的、有关大脑和心灵的所有现象，即生命可以通过它的表达方式来认识，形式总是服从于功能的。这就是自然法则。







